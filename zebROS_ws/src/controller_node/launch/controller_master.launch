<?xml version="1.0"?>

<launch>
  <!--
  Master Node Launcher
  * ZED Wrapper Instance
  * Goal Detection Node
  * NavX Publisher Node
  * Rosbag recording (Optional)
	-->
  
  <arg name="resolution" default="2" />
  <arg name="frame_rate" default="60" />
  <arg name="quality" default="3" />
  <arg name="brightness" default="2" />
  <arg name="contrast" default="5" />
  <arg name="hue" default="6" />
  <arg name="saturation" default="3" />
  <arg name="gain" default="0" />
  <arg name="exposure" default="45" />
  <arg name="whitebalance" default="-1" />
  <arg name="name" default="zed_goal" />

  <arg name="record" default="False" />
  <arg name="down_sample" default="False" />
  <arg name="sub_rate" default="10" />
  <arg name="pub_rate" default="1" />

  <group ns="$(arg name)">
    <include file="$(find zed_wrapper)/launch/zed_camera.launch">
      <arg name="zed_name" value="$(arg name)" />
      <arg name="resolution" value="$(arg resolution)" />
      <arg name="frame_rate" value="$(arg frame_rate)" />
      <arg name="quality" value="$(arg quality)" />
      <arg name="brightness" value="$(arg brightness)" />
      <arg name="contrast" value="$(arg contrast)" />
      <arg name="hue" value="$(arg hue)" />
      <arg name="saturation" value="$(arg saturation)" />
      <arg name="gain" value="$(arg gain)" />
      <arg name="exposure" value="$(arg exposure)" />
      <arg name="whitebalance" value="$(arg whitebalance)" />
    </include>
</group>

  <node name="goal_detection_node" pkg="goal_detection" type="goal_detection_node" respawn="true" output="screen">
  	<param name="down_sample" value="$(arg down_sample)" />
  	<param name="sub_rate" value="$(arg sub_rate)" />
  	<param name="pub_rate" value="$(arg pub_rate)" />
  </node>

	<!--stuff added from record_slave-->

  <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_zed_fuel_center" args="0.297688 0.0079375 0.1749425 0 0 0 base_link $zed_fuel_center" />

  <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_navx" args="-0.2914015 -0.072263 0.0244348 0 0 0 base_link navx" />

  <include file="$(find controller_node)/launch/fuse_odom.launch"/>

  <include file="$(find rplidar_ros)/launch/rplidar.launch" />
  <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_laser" args="0.4175125 -0.3184779 0.22178 3.14159265 0 0 base_link laser" />

  <include file="$(find controller_node)/launch/gmapping.launch"/>

  <remap from="/cmd_vel" to="frcrobot/swerve_drive_controller/cmd_vel"/>
  <include file="$(find controller_node)/launch/move_base.launch"/>

	<!-- end stuff added from record_slave -->
	<!--
  <node name="navx_publisher_node" pkg="navx_publisher" type="navx_publisher_node" respawn="true" /> -->
  <include file="$(find controller_node)/launch/record_master.launch" if="$(arg record)">
    <arg name="down_sample" value="$(arg down_sample)" />
</include>
	
    
</launch>
